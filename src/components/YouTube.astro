---
// Adapted from: https://github.com/delucis/astro-embed/blob/main/packages/astro-embed-youtube/YouTube.astro
import type { JSX } from "astro/jsx-runtime";
import "lite-youtube-embed/src/lite-yt-embed.css";

export interface Props extends astroHTML.JSX.HTMLAttributes {
  id: string;
  poster?: string;
  posterQuality?: "max" | "high" | "default" | "low";
  params?: string;
  playlabel?: string;
}

const {
  id,
  poster,
  posterQuality = "default",
  title,
  ...attrs
} = Astro.props as Props;

const videoid = id;
const posterFile =
  {
    max: "maxresdefault",
    high: "sddefault",
    default: "hqdefault",
    low: "default",
  }[posterQuality] || "hqdefault";
const posterURL =
  poster || `https://i.ytimg.com/vi/${videoid}/${posterFile}.jpg`;
const href = `https://youtube.com/watch?v=${videoid}`;
---

<lite-youtube
  {videoid}
  {title}
  data-title={title}
  {...attrs}
  style={`background-image: url('${posterURL}');`}
>
  <a {href} class="lty-playbtn">
    <span class="lyt-visually-hidden">{attrs.playlabel}</span>
  </a>
</lite-youtube>

<script src="lite-youtube-embed"></script>

<style is:global>
  lite-youtube > iframe {
    all: unset !important;
    width: 100% !important;
    height: 100% !important;
    position: absolute !important;
    inset: 0 !important;
    border: 0 !important;
  }
</style>
