---
import type { ImageMetadata } from "astro";
import { Picture as AstroPicture, getImage } from "astro:assets";

interface Props {
  src: string;
  alt: string;
  width?: number;
  height?: number;
}

const { src, alt, ...rest } = Astro.props;
const imageLoaders = import.meta.glob<{ default: ImageMetadata }>("/res/**/*");
if (!imageLoaders[src]) {
  throw new Error(`${src} not found in /res folder!`);
}
const importedImage = imageLoaders[src]();

const image = await getImage({
  src: importedImage,
  formats: ["webp"],
});
---

<!-- <>
  <AstroPicture
    src={importedImage}
    alt={alt}
    formats={["webp"]}
    densities={[0.5, 1, 1.5, 2]}
    {...rest}
  />
</> -->
<pre>
  <code>
    {JSON.stringify(image, null, 2)}
  </code>
</pre>
